[DEFAULT]
debug = {{ glance.debug }}

use_syslog = false
use_stderr = true
use_forwarded_for = true

{% if security.tls.enabled %}
bind_host = 127.0.0.1
bind_port = {{ glance.tls.registry_port }}
#http_proxy_information = 127.0.0.1:{{ glance.api_port.cont }}
{% else %}
bind_host = {{ network_topology["private"]["address"] }}
bind_port = {{ glance.registry_port.cont }}
{% endif %}

[database]
connection = mysql+pymysql://{{ glance.db.username }}:{{ glance.db.password }}@{{ address(service.database) }}/{{ glance.db.name }}
max_retries = -1

[keystone_authtoken]
auth_uri = {{ address('keystone', keystone.public_port, with_scheme=True, tls=True) }}
auth_url = {{ address('keystone', keystone.admin_port, with_scheme=True, tls=True) }}
auth_type = password
project_domain_id = default
user_domain_id = default
project_name = service
username = {{ glance.user }}
password = {{ glance.password }}
memcached_servers = {{ address('memcached', memcached.port) }}

[paste_deploy]
flavor = keystone

{% if searchlight is defined and searchlight.services.glance -%}
[oslo_messaging_notifications]
driver = {{ searchlight.notification_driver }}
{%- endif %}

{# rpc config is required for notifications in stable/mitaka #}
{{ oslo_messaging[messaging.backend.rpc]('rpc_config') }}
{{ oslo_messaging[messaging.backend.notifications]('notifications_config') }}
